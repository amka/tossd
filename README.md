# Cервис управления соглашениями

## Описание моделей и API

* **Agreement** - соглашение, которое имеет следующие поля:
    * внутреннее название
    * публичный заголовок
    * публичный текст в формате html, markdown или plain
    * статус: черновик или опубликован
    * дату публикации
    * дату создания
    * дату изменения
    * автора последнего изменения
    * флаг удаления
* **AgreementAcceptance** - состояние принятия соглашения пользователем, которое имеет следующие поля:
    * идентификатор соглашения
    * идентификатор пользователя
    * флаг принятия
    * дату принятия
* **AgreementsService** - сервис управления соглашениями, который предоставляет следующие методы:
    * `CreateAgreement()` - создает новое соглашение
    * `UpdateAgreement()` - обновляет существующее соглашение
    * `DeleteAgreement()` - удаляет существующее соглашение
    * `GetAgreement()` - возвращает соглашение по идентификатору
    * `GetAgreementAcceptances()` - возвращает все состояния принятия соглашения для пользователя
    * `SetAgreementAcceptance()` - устанавливает состояние принятия соглашения для пользователя

Вот некоторые дополнительные детали:

* **Формат текста соглашения** определяется полем `public_text`. Это поле может содержать текст в формате html, markdown или plain.
* **Дата публикации** позволяет планировать публикацию соглашения заранее.
* **Флаг удаления** позволяет пометить соглашение как удаленное. Удаленные соглашения не отображаются в пользовательском интерфейсе, но они все еще могут быть доступны для администратора.
* **Состояние принятия соглашения** определяется полем `accepted` в сущности `AgreementAcceptance`.
* **Актуальной версией считается последняя опубликованная версия в прошлом**. Это означает, что если соглашение было опубликовано несколько раз, то актуальной версией будет самая старая опубликованная версия.
